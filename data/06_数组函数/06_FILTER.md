# FILTER

## 语法

**FILTER**(数组,条件数组,[空数组填充值=#N/A])  
**FILTER**(array,include,[if_empty=#N/A])

### 参数

1. 数组 array：筛选的数组。
2. 条件数组 include：筛选条件。
3. 空数组填充值 if_empty：当条件数组为空时，返回的值。

## 概述

对数组筛选。

### 补充

1. 条件数组必须为一列或者一行或一列。
2. 条件数组 非零值 或 TUER 值保留。
3. 筛选方向根据传入数组是一列还是一行决定。

## 示例

### 示例数据

|     | A    | B      | C    | D     |
| --- | ---- | ------ | ---- | ----- |
| 1   | 部门 | 姓名   | 性别 | 级别  |
| 2   | 魏国 | 张辽   | 男   | 2 级  |
| 3   | 蜀国 | 赵云   | 男   | 2 级  |
| 4   | 吴国 | 孙尚香 | 女   | 3 级  |
| 5   | 吴国 | 甘宁   | 男   | 4 级  |
| 6   | 魏国 | 夏侯惇 | 男   | 4 级  |
| 7   | 魏国 | 郭嘉   | 男   | 5 级  |
| 8   | 蜀国 | 刘备   | 男   | 5 级  |
| 9   | 魏国 | 甄姬   | 女   | 5 级  |
| 10  | 蜀国 | 张飞   | 男   | 7 级  |
| 11  | 魏国 | 曹操   | 男   | 8 级  |
| 12  | 蜀国 | 关羽   | 男   | 10 级 |
| 13  | 蜀国 | 诸葛亮 | 男   | 11 级 |
| 14  | 魏国 | 司马懿 | 男   | 11 级 |
| 15  | 吴国 | 孙权   | 男   | 11 级 |

```excel
FILTER(A2:D15,B2:B15="蜀国")
```

| 返回 |      |        |     |       |
| ---- | ---- | ------ | --- | ----- |
|      | 蜀国 | 赵云   | 男  | 2 级  |
|      | 蜀国 | 刘备   | 男  | 5 级  |
|      | 蜀国 | 张飞   | 男  | 7 级  |
|      | 蜀国 | 关羽   | 男  | 10 级 |
|      | 蜀国 | 诸葛亮 | 男  | 11 级 |

---

```excel
FILTER(A2:D15,A1:D1="姓名")
```

| 返回 |        |
| ---- | ------ |
|      | 张辽   |
|      | 赵云   |
|      | 孙尚香 |
|      | 甘宁   |
|      | 夏侯惇 |
|      | 郭嘉   |
|      | 刘备   |
|      | 甄姬   |
|      | 张飞   |
|      | 曹操   |
|      | 关羽   |
|      | 诸葛亮 |
|      | 司马懿 |
|      | 孙权   |

---

```excel
FILTER(A2:D15,B2:B15="晋","无")
```

| 返回 |     |
| ---- | --- |
|      | 无  |

---

```excel
FILTER(A2:D15,(B2:B15="吴国")*(D2:D15="女"),"无")
```

| 返回 |      |        |     |      |
| ---- | ---- | ------ | --- | ---- |
|      | 吴国 | 孙尚香 | 女  | 3 级 |
