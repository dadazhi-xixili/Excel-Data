# HLOOKUP

## 语法

**HLOOKUP**(查找值,查找区域,返回行索引[,查找模式=TRUE])  
**HLOOKUP**(lookup_value,table_array,row_index_num,[range_lookup=TRUE])

### 参数

1. 查找值 lookup_value：查找值。
    - 支持通配符。
2. 查找区域 table_array：查找区域。
3. 返回行索引 col_index_num：返回行数。
4. 查找模式 range_lookup：查找模式。
    - TRUE：二分法查找模式，参考 LOOKUP 篇。
    - FALSE：线性查找模式。

## 概述

从数组或区域中的第一行查找值，返回查找值所在列偏移后的值。

### 补充

1. ❗ 不懂二分法搜索不要用二分法模式搜索，微软官方的描述(近似匹配)是错误的。
2. 搜索范围是数组的第一行，确保搜索范围在第一行。  
   可使用数组函数来构建内存数组。
3. 通配符：
    - \*：大于 1 长度的任意字符。
    - ?：任意一个字符。
    - ~：使 \* 和 ? 失效。
4. 未成功匹配则返回#N/A。

## 示例

### 示例数据

|  | A | B | C | D | E | F | G | H | I | J | K | L | M | N | O |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | 部门 | 魏国 | 蜀国 | 吴国 | 吴国 | 魏国 | 魏国 | 蜀国 | 魏国 | 蜀国 | 魏国 | 蜀国 | 蜀国 | 魏国 | 吴国 |
| 2 | 姓名 | 张辽 | 赵云 | 孙尚香 | 甘宁 | 夏侯惇 | 郭嘉 | 刘备 | 甄姬 | 张飞 | 曹操 | 关羽 | 诸葛亮 | 司马懿 | 孙权 |
| 3 | 性别 | 男 | 男 | 女 | 男 | 男 | 男 | 男 | 女 | 男 | 男 | 男 | 男 | 男 | 男 |
| 4 | 级别 | 2 | 2 | 3 | 4 | 4 | 5 | 5 | 5 | 7 | 8 | 10 | 11 | 11 | 11 |
| 5 | 数量 | 79 | 72 | 102 | 56 | 117 | 76 | 57 | 114 | 57 | 111 | 55 | 61 | 91 | 58 |
| 6 | 金额 | 9460 | 8580 | 12200 | 6760 | 13980 | 9060 | 6840 | 13720 | 6840 | 13260 | 6580 | 7280 | 10960 | 6900 |

### 线性查找

```excel
HLOOKUP("张飞",B2:O6,5,)
```

-   B3 不等于 "张飞"，向右查找。
-   C3 不等于 "张飞"，向右查找。
-   ...
-                 J3 等于 "张飞"，终止搜索。
-   取 J3 所在列与第 5 行交集的值，即 O6 的值。

返回：  
6840

---

### 通配符查找

```excel
HLOOKUP("孙*",B2:O6,5,)
```

-   B3 不匹配 "孙\*"，向右查找。
-   C3 不匹配 "孙\*"，向右查找。
-   D3 匹配 "孙\*"，终止搜索。
-             取 D3 所在列与第 5 行交集的值，即 D6 的值。

返回：  
12200

---

### 二分法查找

不想写了，看 VLOOKUP 篇。  
\(╯°□°）╯︵ ┻━┻  
💢💥💢💥💢
