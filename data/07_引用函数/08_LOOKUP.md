# LOOKUP

## 语法

**LOOKUP**(查找值,查找数组[,返回数组])  
**LOOKUP**(lookup_value,lookup_vector[,result_vector])

### 参数

1. 查找值 lookup_value：要查找的值。
2. 查找数组 lookup_vector：升序数组。
3. 返回数组 result_vector：返回的数组。
    - 省略则返回查找数组参数。

## 概述

使用二分法比较，从升序数组中查找值。

### 补充

1. 无匹配值则返回小于查找值的最大值。
2. 无同类型值或无小于查找值的值则返回#N/A。
3. 参与比较的可以是文本、布尔值、数值。
4. 重点 ❗：记住要从升序序列中查找，返回值是最接近查找值且小于查找值的值。

### 示例数据

|     | A   | B   |
| --- | --- | --- |
| 1   | 10  | A   |
| 2   | 20  | B   |
| 3   | 30  | C   |
| 4   | 40  | D   |
| 5   | 50  | E   |
| 6   | 60  | F   |
| 7   | 70  | G   |
| 8   | 80  | H   |
| 9   | 90  | I   |
| 10  | 100 | J   |
| 11  | 110 | K   |
| 12  | 120 | L   |
| 13  | 130 | M   |

### 二分法比较模式

```excel
LOOKUP(80,A1:A13,B1:B13)
```

-   {10;20;30;40;50;60;70;80;90;100;110;120;130}  
    有 13 个元素，中间索引是 7。  
    取索引为 7 的值与 80 比较，80 大于 70,搜索后半部分。
-   {80;90;100;110;120;130}  
    有 6 个元素，中间索引是 10 和 11。  
    中间索引数量为 2 时，取较小索引比较。  
    取索引为 10 的值比较，80 小于 100,搜索前半部分。
-   {80;90}  
    有 2 个元素，中间索引为 8 和 9。  
    取较小索引比较，80 等于 80,搜索结束。  
    取索引为 8 的返回值。

返回:  
"H"

---

### 文本匹配

```excel
LOOKUP("H",B1:B13)
```

-   {"A";"B";"C";"D";"E";"F";"G";"H";"I";"J";"K";"L";"M"}  
    有 13 个元素，中间索引为 7。索引为 7 的值与 "H" 比较，"H" 大于 "G",搜索后半部分。
-   {"H";"I","J","K","L","M"}  
    有 6 个元素，中间索引为 10 和 11，中间索引数量为 2，取较小索引 10 比较。  
    "J" 大于 "H"，取前半部分。 |
-   {"H";"I"}  
    "H" 等于 "H"，搜索结束。

返回：  
"H"

---

### 近似值匹配

```excel
LOOKUP(85,A1:A13)
```

-   {10;20;30;40;50;60;70;80;90;100;110;120;130}  
    有 13 个元素，中间索引是 7。  
    取索引为 7 的值与 85 比较，85 大于 70,搜索后半部分。
-   {80;90;100;110;120;130}  
    有 6 个元素，中间索引是 10 和 11。  
    中间索引数量为 2 时，取较小索引比较。  
    取索引为 10 的值比较，85 小于 100,搜索前半部分。
-   {80;90}  
    有 2 个元素，中间索引为 8 和 9。  
    取较小索引比较，85 大于 80,搜索后半部分。
-   {90}  
    90 大于 85。  
    元素数量为 1，搜索结束。  
    返回最后一次与 85 比较且小于 85 的元素索引。  
    取索引为 8 的值。

返回：  
80
