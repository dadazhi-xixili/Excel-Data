# VLOOKUP

## 语法

**VLOOKUP**(查找值,查找区域,返回值列索引,[查找模式=TRUE])  
**VLOOKUP**(lookup_value,table_array,col_index_num,[range_lookup=TRUE])

### 参数

1. 查找值 lookup_value：查找值。
    - 支持通配符。
2. 查找区域 table_array：查找区域。
3. 返回值列索引 col_index_num：返回列数。
4. 查找模式 range_lookup：查找模式。
    - TRUE：二分法查找模式，参考 LOOKUP 篇。
    - FALSE：线性查找模式。

## 概述

从数组或区域中的第一列查找值，返回查找值所在行偏移后的值。

### 补充

1. ❗ 不懂二分法搜索不要用二分法模式搜索，微软官方的描述(近似匹配)是错误的。
2. 搜索范围是数组的第一列，确保搜索范围在第一列。可使用数组函数来构建内存数组。
3. 通配符：
    - \*：大于 1 长度的任意字符。
    - ?：任意一个字符。
    - ~：使 \* 和 ? 失效。
4. 未成功匹配则返回#N/A。

## 示例

### 示例数据

|     | A    | B      | C    | D    | E    | F     |
| --- | ---- | ------ | ---- | ---- | ---- | ----- |
| 1   | 部门 | 姓名   | 性别 | 级别 | 数量 | 金额  |
| 2   | 魏国 | 张辽   | 男   | 2    | 79   | 9460  |
| 3   | 蜀国 | 赵云   | 男   | 2    | 72   | 8580  |
| 4   | 群雄 | 貂蝉   | 女   | 2    | 60   | 7140  |
| 5   | 吴国 | 孙尚香 | 女   | 3    | 102  | 12200 |
| 6   | 吴国 | 甘宁   | 男   | 4    | 56   | 6760  |
| 7   | 魏国 | 夏侯惇 | 男   | 4    | 117  | 13980 |
| 8   | 群雄 | 华雄   | 男   | 4    | 47   | 5660  |
| 9   | 魏国 | 郭嘉   | 男   | 5    | 76   | 9060  |
| 10  | 蜀国 | 刘备   | 男   | 5    | 57   | 6840  |
| 11  | 魏国 | 甄姬   | 女   | 5    | 114  | 13720 |
| 12  | 蜀国 | 张飞   | 男   | 7    | 57   | 6840  |
| 13  | 群雄 | 华佗   | 男   | 8    | 65   | 7780  |
| 14  | 魏国 | 曹操   | 男   | 8    | 111  | 13260 |
| 15  | 蜀国 | 关羽   | 男   | 10   | 55   | 6580  |
| 16  | 群雄 | 袁术   | 男   | 10   | 103  | 12400 |
| 17  | 蜀国 | 诸葛亮 | 男   | 11   | 61   | 7280  |
| 18  | 魏国 | 司马懿 | 男   | 11   | 91   | 10960 |
| 19  | 吴国 | 孙权   | 男   | 11   | 58   | 6900  |

### 线性查找

```excel
VLOOKUP("张飞",B2:F19,5,)
```

-   B2 不等于 "张飞"，向下查找。
-   B3 不等于 "张飞"，向下查找。
-   ...
-   B12 等于 "张飞"，终止搜索。
-   取 B12 所在行与第 5 列交集的值，即 F12 的值。

返回：  
6840

---

### 通配符查找

```excel
VLOOKUP("孙*",B2:F19,5,)
```

-   B2 不匹配 "孙\*"，向下查找。
-   B3 不匹配 "孙\*"，向下查找。
-   ...
-   B5 匹配 "孙\*"，终止搜索。
-   取 B5 所在行与第 5 列交集的值，即 F5 的值。

返回：  
12200

---

### 二分法查找

不想写了，看 lookup 篇。  
\(╯°□°）╯︵ ┻━┻  
💢💥💢💥💢
