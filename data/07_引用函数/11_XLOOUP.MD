# XLOOKUP

## 语法

**XLOOKUP**(查找值,查找数组,返回数组[,无匹配返回值=#N/A,匹配模式=0,搜索模式=1])  
**XLOOKUP**(lookup_value,lookup_array,return_array,[if_not_found=#N/A,match_mode=0,search_mode=1])

### 参数

1. 查找值 lookup_value：查找值。
2. 查找数组 lookup_array：要查找的数组或区域。
3. 返回数组 return_array：与查找数组长度相同的返回数组。
4. 无匹配返回值 if_not_found：无匹配返回值。
5. 匹配模式 match_mode：匹配模式。
    - 0：精确查找值。
    - -1：小于等于查找值。
    - 1：大于等于查找值。
    - 2：通配符匹配。
    - 3：正则表达式匹配。
6. 搜索模式 search_mode：搜索模式。
    - 1：从前向后线性搜索。
    - -1：从后向前线性搜索。
    - 2：正序二分法搜索。
    - -2：降序二分法搜索。

## 概述

匹配第一个匹配值，返回该值对应的返回值。

### 补充

1. 启用二分法模式后，匹配值依然是根据匹配模式决定的，不会像 LOOKUP 一样匹配小于或等于的值，需要自行控制。
2. 返回数组可以是多列或多行，但行轴或列轴要与查找数组一致。
3. 与 LOOKUP、VLOOKUP、HLOOKUP 不同，XLOOKUP 可以返回引用属性，前提是传入的返回数组传入区域引用。

## 示例

### 示例数据 1

|     | A    | B      | C    | D    | E    | F     |
| --- | ---- | ------ | ---- | ---- | ---- | ----- |
| 1   | 部门 | 姓名   | 性别 | 级别 | 数量 | 金额  |
| 2   | 魏国 | 张辽   | 男   | 2    | 79   | 9460  |
| 3   | 蜀国 | 赵云   | 男   | 2    | 72   | 8580  |
| 4   | 群雄 | 貂蝉   | 女   | 2    | 60   | 7140  |
| 5   | 吴国 | 孙尚香 | 女   | 3    | 102  | 12200 |
| 6   | 吴国 | 甘宁   | 男   | 4    | 56   | 6760  |
| 7   | 魏国 | 夏侯惇 | 男   | 4    | 117  | 13980 |
| 8   | 群雄 | 华雄   | 男   | 4    | 47   | 5660  |
| 9   | 魏国 | 郭嘉   | 男   | 5    | 76   | 9060  |
| 10  | 蜀国 | 刘备   | 男   | 5    | 57   | 6840  |
| 11  | 魏国 | 甄姬   | 女   | 5    | 114  | 13720 |
| 12  | 蜀国 | 张飞   | 男   | 7    | 57   | 6840  |
| 13  | 群雄 | 华佗   | 男   | 8    | 65   | 7780  |
| 14  | 魏国 | 曹操   | 男   | 8    | 111  | 13260 |
| 15  | 蜀国 | 关羽   | 男   | 10   | 55   | 6580  |
| 16  | 群雄 | 袁术   | 男   | 10   | 103  | 12400 |
| 17  | 蜀国 | 诸葛亮 | 男   | 11   | 61   | 7280  |
| 18  | 魏国 | 司马懿 | 男   | 11   | 91   | 10960 |
| 19  | 吴国 | 孙权   | 男   | 11   | 58   | 6900  |

#### 常规

```excel
XLOOKUP("关羽",B1:B19,F19)
```

返回：  
6580

---

```excel
XLOOKUP("关羽",B1:B19,A1:F19)
```

| 返回 |      |      |     |     |     |      |
| ---- | ---- | ---- | --- | --- | --- | ---- |
|      | 蜀国 | 关羽 | 男  | 10  | 55  | 6580 |

---

```excel
XLOOKUP("姓名",A1:F1,A2:F19)
```

| 返回 |        |
| ---- | ------ |
|      | 张辽   |
|      | 赵云   |
|      | 貂蝉   |
|      | 孙尚香 |
|      | 甘宁   |
|      | 夏侯惇 |
|      | 华雄   |
|      | 郭嘉   |
|      | 刘备   |
|      | 甄姬   |
|      | 张飞   |
|      | 华佗   |
|      | 曹操   |
|      | 关羽   |
|      | 袁术   |
|      | 诸葛亮 |
|      | 司马懿 |
|      | 孙权   |

---

#### 通配符

```excel
XLOOKUP("张?",B2:B19,F2:F19,,2)
```

返回：  
9460

---

#### 正则

```excel
XLOOKUP("张.",B2:B19,F2:F19,,2)
```

返回：  
9460

---

#### 倒查

```excel
XLOOKUP("张*",B2:B19,F2:F19,,2,-1)
```

返回：  
6840

---

#### 返回引用属性

```excel
XLOOKUP(4,D2:D19,A2:A19):XLOOKUP(8,D2:D19,F2:F19,,,-1)
```

| 返回 |      |        |     |     |     |       |
| ---- | ---- | ------ | --- | --- | --- | ----- |
|      | 吴国 | 甘宁   | 男  | 4   | 56  | 6760  |
|      | 魏国 | 夏侯惇 | 男  | 4   | 117 | 13980 |
|      | 群雄 | 华雄   | 男  | 4   | 47  | 5660  |
|      | 魏国 | 郭嘉   | 男  | 5   | 76  | 9060  |
|      | 蜀国 | 刘备   | 男  | 5   | 57  | 6840  |
|      | 魏国 | 甄姬   | 女  | 5   | 114 | 13720 |
|      | 蜀国 | 张飞   | 男  | 7   | 57  | 6840  |
|      | 群雄 | 华佗   | 男  | 8   | 65  | 7780  |
|      | 魏国 | 曹操   | 男  | 8   | 111 | 13260 |

---

### 示例数据 2

|     | A   | B   |
| --- | --- | --- |
| 1   | 10  | M   |
| 2   | 20  | L   |
| 3   | 30  | K   |
| 4   | 40  | J   |
| 5   | 50  | I   |
| 6   | 60  | H   |
| 7   | 70  | G   |
| 8   | 80  | F   |
| 9   | 90  | E   |
| 10  | 100 | D   |
| 11  | 110 | C   |
| 12  | 120 | B   |
| 13  | 130 | A   |

#### 二分法

> 启用二分法要先确保查找区域是正序或倒序。  
> 匹配模式参数也要做相应调整。

```excel
XLOOKUP(85,A1:A13,B1:B13,"无",,2)
```

返回：  
"无"

---

```excel
XLOOKUP(85,A1:A13,B1:B13,"无",1,2)
```

返回：  
"I"

---

```excel
XLOOKUP(85,A1:A13,B1:B13,"无",-1,2)
```

返回：  
"H"
