# 错误

## 表达式

**\#error_name!**

## 概述

错误值，用于表示计算错误。

## 示例

| 错误值 | 类型 | 描述 | 常见原因及典型案例 |
| --- | --- | --- | --- |
| `#CALC!` | 计算错误 | 动态数组运算异常 | FILTER 函数返回空数组但未用 IFERROR 处理 |
| `#CIRCULAR!` | 引用错误 | 循环引用（旧版显示`#循环引用!`） | A1 单元格输入`=A1+1`；间接循环引用（如 A1=B1,B1=A1） |
| `#DIV/0!` | 数学错误 | 除数为零 | `=1/0`；`=SUM(A:A)/COUNTIF(B:B,"=0")` 当 B 列全为 0 时 |
| `#FIELD!` | 数据结构错误 | 字段引用无效 | Power Query 合并表时列名不匹配；`=QUERY(A:D,"select E")` 但数据仅 A-D 列 |
| `#GETTING_DATA` | 数据连接 | 外部数据加载中 | 正在刷新的 SQL 查询；未完成的 WEBSERVICE 函数调用 |
| `#N/A` | 查找错误 | 值不可用 | `=VLOOKUP("X",A:B,2,0)` 但 A 列无"X"；XLOOKUP 未设置找不到时的返回值 |
| `#NAME?` | 语法错误 | 未识别的函数/名称 | 拼写错误（`=SUMM(A1:A10)`）；未定义名称（`=Sales_Total`但未创建该名称） |
| `#NULL!` | 引用错误 | 无效交集运算 | `=SUM(A1:A10 B1:B10)`（区域无重叠） |
| `#NUM!` | 数值错误 | 计算范围溢出 | `=ACOS(2)`（反余弦超出定义域）；`=FACT(1000)`（阶乘超过 Excel 计算极限） |
| `#REF!` | 引用错误 | 单元格引用失效 | 删除被引用的工作表；剪切 A1 后粘贴到 B1，导致原公式`=A1+1`变为`=#REF!+1` |
| `#SPILL!`\|`#溢出!` | 数组错误 | 动态数组无法展开 | `=SEQUENCE(5)`下方单元格非空；`=FILTER(A:A,B:B="X")`结果区域被合并单元格阻挡 |
| `#VALUE!` | 类型错误 | 参数类型不匹配 | `="ABC"+123`；`=DATE("2024/13/01")`（月份无效） |
| `#BLOCKED!` | 权限错误 | 访问被禁止 | Google Sheets 中未授权访问 API；企业版 Excel 阻止外部连接 |
| `#CONNECT!` | 连接错误 | 数据源链接失败 | Power Query 数据源路径变更；ODBC 连接字符串错误 |
| `#DATA!` | 数据错误 | 数据格式非法 | `=VALUE("12X5")`文本转数字失败；导入的 CSV 文件编码错误 |
| `#PYTHON!` | 脚本错误 | Python 代码执行失败 | Excel Labs 中未安装 pandas 库；Python 脚本缩进错误 |
| `#TIMEOUT!` \|`#超时!` | 连接错误 | 操作超时 | SQL 查询超过 30 秒未响应；`=WEBSERVICE()`请求的 URL 无应答 |
| `#UNKNOWN!` | 系统错误 | 未分类异常 | 第三方插件崩溃；内存不足导致计算中断 |
