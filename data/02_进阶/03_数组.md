# 数组

## 概述

由数值、文本、布尔值、错误值、嵌套类型、特殊值、错误值组成的矩阵。

### 补充

1. 数组维度：
   - 一维数组：行长度为 1 或列长度为一的数组。
   - 二维数组：行轴和列轴长度都大于 1 的数组。
   - 划重点 ❗：一维数组本质是二维数组，区别只是一维数组的行轴或列轴长度为 1。
   - 还是重点 ❕：数组与引用的区别，数组只能以二维形式存在，而引用的区域可以是多维的。要构建多维数组只能通过函数、VBA 等特殊手段实现，且最终返回的只能是二维数组或 1 个值。
2. 广播机制：
   - 没想到吧 💥,全是重点。
   - 数组长度为 1 的轴在与另一个数组运算时会自动填充至对应轴相同的长度。
   - 轴长度不同且轴长度都大于 1 时，无法交集值区域会返回#N/A。

## 示例

### 字面量构建数组

字面量构建数组可以是数值、文本、布尔值、#N/A。

#### 构建一维数组

```excel
{1,2,3}
```

| 返回 |     |     |     |
| ---- | --- | --- | --- |
|      | 1   | 2   | 3   |

```excel
{"1";TRUE;#N/A}
```

| 返回 |      |
| ---- | ---- |
|      | "1"  |
|      | TRUE |
|      | #N/A |

#### 构建二维数组

```exce;
{1,2;3,4}
```

| 返回 |     |     |
| ---- | --- | --- |
|      | 1   | 2   |
|      | 3   | 4   |

### 广播

```execl
// 行轴长度3 列轴长度1
{1,2,3}
// 行轴长度1 列轴长度3
{1;2;3}


{1,2,3}*{1;2;3}
```

| 返回 |     |     |     |
| ---- | --- | --- | --- |
|      | 1   | 2   | 3   |
|      | 2   | 4   | 6   |
|      | 3   | 6   | 9   |

### 不匹配轴错误

```excel
{1,2,3} + {1,2}
```

| 返回 |     |     |      |
| ---- | --- | --- | ---- |
|      | 2   | 4   | #N/A |

### 构建函数数组

```excel
HSTACK(SUM,MAX,MIN,COUNT)
```

### 构建图像跳转链接数组

```excel
VSTACK(
    HYPERLINK(
        "#Sheet1!A1",
        IMAGE("https://uhf.microsoft.com/images/microsoft/RE1Mu3b.png")
    ),
    HYPERLINK(
        "#Sheet1!A1",
        IMAGE("https://uhf.microsoft.com/images/microsoft/RE1Mu3b.png")
    )
)
```
