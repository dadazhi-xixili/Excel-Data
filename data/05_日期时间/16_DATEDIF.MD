# DATEDIF

## 语法

**DATEDIF**(开始日期,结束日期,单位)  
**DATEDIF**(start_date,end_date,unit)

### 参数

1. 开始日期 start_date：开始日期。
    - 文本值，则尝试转换。
    - 数值，则直接使用。
2. 结束日期 end_date：结束日期。
3. 单位 unit：返回类型。
    - "Y"|"y"：相隔年数。
    - "M"|"m"：相隔月数。
    - "D"|"d"：相隔天数。
    - "MD"|"md"：忽略年和月，单独计算日相距。开始日大于结束日会向上取一月。
    - "YM"|"ym"：忽略年和日，单独计算月相距。开始月大于结束月会向上取一年。
    - "YD"|"yd"：忽略年，单独计算月日相距。开始月日大于结束月日会向上取一年。

## 概述

返回两个日期之间相隔的指定单位数。

### 补充

1. 开始日期不能大于结束日期，无论使用什么单位。否则会返回错误。

## 示例

| 示例                                       | 返回 |
| ------------------------------------------ | ---- |
| =DATEDIF("2024/7/21",DATE(2025,7,20),"y")  | 0    |
| =DATEDIF("2024/7/21",DATE(2025,7,22),"y")  | 1    |
| =DATEDIF("2025/7/21",DATE(2025,8,21),"m")  | 1    |
| =DATEDIF("2024/7/21",DATE(2025,7,22),"m")  | 12   |
| =DATEDIF("2023/7/21",DATE(2025,8,22),"ym") | 1    |
| =DATEDIF("2023/7/21",DATE(2025,6,22),"ym") | 11   |
| =DATEDIF("2025/7/21",DATE(2025,7,22),"d")  | 1    |
| =DATEDIF("2024/7/21",DATE(2025,7,22),"d")  | 366  |
| =DATEDIF("2025/7/21",DATE(2025,8,22),"yd") | 32   |
| =DATEDIF("2023/7/21",DATE(2025,7,20),"yd") | 365  |
| =DATEDIF("2023/7/21",DATE(2025,7,22),"md") | 1    |
| =DATEDIF("2023/7/21",DATE(2025,7,20),"md") | 29   |
