# TEXTSPLIT

## 语法

**TEXTSPLIT**(文本,列分隔符[,行分隔符,忽略空值=FALSE,大小写=0,空值填充=#N/A])  
**TEXTSPLIT**(text,col_delimiter,[row_delimiter,ignore_empty=FALSE,match_mode=0,pad_with=#N/A])

### 参数

1. 待处理的文本 text：待处理的文本。
2. 列分隔符 col_delimiter：列分隔符。
    - 可传递数组，且不会广播。
    - 识别到列分隔符后,返回数组所在行添加列。
3. 行分隔符 row_delimiter：行分隔符。
    - 可传递数组，且不会广播。
    - 识别到行分隔符后，返回数组添加行。
4. 忽略空值 ignore_empty：
    - FALSE: 不忽略空值。
    - TRUE: 忽略空值。
5. 大小写 match_mode：
    - 0: 区分大小写。
    - 1: 不区分大小写。
6. 填充值 pad_with：换行时填充的值。

## 概述

按分隔符拆分文本为数组。

### 补充

1. 与列分隔符相同时，优先识别为行分隔符。
2. 最后展开的数组，行数由行分隔符触发次数决定，列数由列分隔符触发最多次数的行决定。
3. 换行未对齐的空白区域会由填充值区域填充。
4. 填充值可以时数组，按数组的对齐机制填充，未覆盖区域仍然会是#N/A。

## 示例

### 常规

```excel
TEXTSPLIT("1,2,3",",")
```

| 返回 |     |     |     |
| ---- | --- | --- | --- |
|      | 1   | 2   | 3   |

---

```excel
TEXTSPLIT("1,2,3",,",")
```

| 返回 |     |
| ---- | --- |
|      | 1   |
|      | 2   |
|      | 3   |

---

```excel
TEXTSPLIT("1,;3,4",",",";")
```

过程：

1. {"1"}
2. {"1",""}
3. {"1","";"3"}
4. {"1","";"3","4"}

| 返回 |     |     |
| ---- | --- | --- |
|      | 1   |     |
|      | 3   | 4   |

---

```excel
TEXTSPLIT("1;3,4",",",";")
```

过程：

1. {"1"}
2. {"1";"3"}
3. {"1";"3","4"}

| 返回 |     |      |
| ---- | --- | ---- |
|      | 1   | #N/A |
|      | 3   | 4    |

---

### 数组分隔符

```excel
TEXTSPLIT("1,;3,4",{",",";"})
```

过程：

1. {"1"}
2. {"1",""}
3. {"1","","3"}
4. {"1","","3","4"}

| 返回 |     |     |     |     |
| ---- | --- | --- | --- | --- |
|      | 1   |     | 3   | 4   |

---

### 忽略空值

```excel
TEXTSPLIT("1,,3,4",",",,1)
```

过程：

1. {"1"}
2. {"1",""}
3. {"1","";"3"}
4. {"1","","3","4"}
5. {"1","3","4"}

| 返回 |     |     |     |
| ---- | --- | --- | --- |
|      | 1   | 2   | 3   |

---

```excel
TEXTSPLIT("1,;3,4",",",";",1)
```

过程：

1. {"1"}
2. {"1",""}
3. {"1","";"3"}
4. {"1","";"3","4"}
5. {"1","3","4"}

| 返回 |     |     |
| ---- | --- | --- |
|      | 1   |     |
|      | 3   | 4   |

---

### 分隔符优先级

```excel
TEXTSPLIT("1,2,3",",",",")
```

| 返回 |     |
| ---- | --- |
|      | 1   |
|      | 2   |
|      | 3   |

---

### 填充

```excel
TEXTSPLIT("1;3,4",",",";",,,"空")
```

过程：

1. {"1"}
2. {"1";"3"}
3. {"1";"3","4"}
4. {"1","空";"3","4"}

| 返回 |     |     |
| ---- | --- | --- |
|      | 1   | 空  |
|      | 3   | 4   |
