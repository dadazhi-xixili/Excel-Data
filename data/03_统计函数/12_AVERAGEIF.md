# AVERAGEIF

## 语法

**AVERAGEIF**(条件区域,条件[,返回值区域])  
**AVERAGEIF**(range,criteria[,average_range])

### 参数

1. 条件区域 range：要筛选的区域。
2. 条件 criteria：筛选条件。
    - 以文本形式输入的条件表达式，支持通配符匹配。
3. 返回值区域 average_range：返回值区域。

## 概述

对符合条件表达式的区域，求平均值。

### 补充

1. 条件可使用通配符。
2. 省略返回值区域时会尝试把条件区域作为返回值区域。
3. 通配符：
    - \*：匹配任意字符，长度任意。
    - ?：匹配任意字符，长度为 1。
    - ~：取消\*或?的匹配。
4. 比较表达式可对文本生效，参考字符编码。
5. 只会对条件区域与比较区域可交集长度与宽度进行运算。

## 示例

## 示例数据

|     | A    | B      | C     | D    |
| --- | ---- | ------ | ----- | ---- |
| 1   | 部门 | 姓名   | 数量  | 金额 |
| 2   | 魏国 | 张辽   | 0.1   | 1    |
| 3   | 蜀国 | 赵云   | 0.01  | 10   |
| 4   | 吴国 | 孙尚香 | 0.001 | 1000 |
| 5   | 吴国 | 甘宁   | 0.001 | 1000 |
| 6   | 魏国 | 夏侯惇 | 0.1   | 1    |
| 7   | 魏国 | 郭嘉   | 0.1   | 1    |
| 8   | 蜀国 | 刘备   | 0.01  | 10   |
| 9   | 魏国 | 甄姬   | 0.1   | 1    |
| 10  | 蜀国 | 张飞   | 0.01  | 10   |
| 11  | 魏国 | 曹操   | 0.1   | 1    |
| 12  | 蜀国 | 关羽   | 0.01  | 10   |
| 13  | 蜀国 | 诸葛亮 | 0.01  | 10   |
| 14  | 魏国 | 司马懿 | 0.1   | 1    |
| 15  | 吴国 | 孙权   | 0.001 | 1000 |

### 示例：省略返回值区域

```excel
AVERAGEIF(C2:C15,"<0.01")
```

返回：  
0.006625

---

### 示例：通配符

#### 匹配 张姓

```excel
AVERAGEIF(B2:B15,"张*",C2:C15)
```

返回：  
0.055

---

#### 匹配 名字长度为三字

```excel
AVERAGEIF(B2:B15,"???",C2:C15)
```

返回：  
0.05275
