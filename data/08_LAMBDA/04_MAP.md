# MAP

## 语法

**MAP**(数组 1[,数组 2...],自定义函数(参数 1[,参数 2...],表达式) | 函数)  
**MAP**(array1[,array2...],LAMBDA(parameter1[,parameter2...],calculation) | function)

### 参数

1. 数组 1 array1：要处理的数组。
2. 参数 1 parameter1：处理数组的函数的参数。
3. 自定义函数 LAMBDA：处理数组的函数。
4. 函数 function：处理数组的函数。
5. 数组\_n array_n：要处理的数组。
6. 参数\_n parameter_n：处理数组的函数的参数，参数与数组必须成对存在。

## 概述

对传入数组的每一个元素应用传入的函数。

### 常见错误

1. 传入的函数返回必须是一个值，不能是数组，否则因无法展开报错。
2. 传入多个数组大小需要一致，否则部分内容会错误。

## 示例

### 示例 1

```excel
MAP({1,2;3,4},LAMBDA(x,x*x))
```

| 结果 |     |     |
| ---- | --- | --- |
|      | 1   | 4   |
|      | 9   | 16  |

---

### 示例 2

```excel
MAP({1,2;3,4},{10,20;30,40},LAMBDA(x,y,x+y))
```

| 过程 |      |      |
| ---- | ---- | ---- |
|      | 1+10 | 2+20 |
|      | 3+30 | 4+40 |

| 结果 |     |     |
| ---- | --- | --- |
|      | 11  | 22  |
|      | 33  | 44  |

---

### 示例 3

```excel
MAP(A1:I9,LAMBDA(x,LET(r,ROW(x),c,COLUMN(x),IF(r<c,"",r&"*"&c&"="&r*c))))
```

| 过程 |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  | LET(r,ROW(x),c,COLUMN(x),IF(1&lt;1,"",1<"\*"&1&"="&1\*1)) | LET(r,ROW(x),c,COLUMN(x),IF(1&lt;2,"",1<"\*"&2&"="&1\*2)) | LET(r,ROW(x),c,COLUMN(x),IF(1&lt;3,"",1<"\*"&3&"="&1\*3)) | LET(r,ROW(x),c,COLUMN(x),IF(1&lt;4,"",1<"\*"&4&"="&1\*4)) | LET(r,ROW(x),c,COLUMN(x),IF(1&lt;5,"",1<"\*"&5&"="&1\*5)) | LET(r,ROW(x),c,COLUMN(x),IF(1&lt;6,"",1<"\*"&6&"="&1\*6)) | LET(r,ROW(x),c,COLUMN(x),IF(1&lt;7,"",1<"\*"&7&"="&1\*7)) | LET(r,ROW(x),c,COLUMN(x),IF(1&lt;8,"",1<"\*"&8&"="&1\*8)) | LET(r,ROW(x),c,COLUMN(x),IF(1&lt;9,"",1<"\*"&9&"="&1\*9)) |
|  | LET(r,ROW(x),c,COLUMN(x),IF(2&lt;1,"",2<"\*"&1&"="&2\*1)) | LET(r,ROW(x),c,COLUMN(x),IF(2&lt;2,"",2<"\*"&2&"="&2\*2)) | LET(r,ROW(x),c,COLUMN(x),IF(2&lt;3,"",2<"\*"&3&"="&2\*3)) | LET(r,ROW(x),c,COLUMN(x),IF(2&lt;4,"",2<"\*"&4&"="&2\*4)) | LET(r,ROW(x),c,COLUMN(x),IF(2&lt;5,"",2<"\*"&5&"="&2\*5)) | LET(r,ROW(x),c,COLUMN(x),IF(2&lt;6,"",2<"\*"&6&"="&2\*6)) | LET(r,ROW(x),c,COLUMN(x),IF(2&lt;7,"",2<"\*"&7&"="&2\*7)) | LET(r,ROW(x),c,COLUMN(x),IF(2&lt;8,"",2<"\*"&8&"="&2\*8)) | LET(r,ROW(x),c,COLUMN(x),IF(2&lt;9,"",2<"\*"&9&"="&2\*9)) |
|  | LET(r,ROW(x),c,COLUMN(x),IF(3&lt;1,"",3<"\*"&1&"="&3\*1)) | LET(r,ROW(x),c,COLUMN(x),IF(3&lt;2,"",3<"\*"&2&"="&3\*2)) | LET(r,ROW(x),c,COLUMN(x),IF(3&lt;3,"",3<"\*"&3&"="&3\*3)) | LET(r,ROW(x),c,COLUMN(x),IF(3&lt;4,"",3<"\*"&4&"="&3\*4)) | LET(r,ROW(x),c,COLUMN(x),IF(3&lt;5,"",3<"\*"&5&"="&3\*5)) | LET(r,ROW(x),c,COLUMN(x),IF(3&lt;6,"",3<"\*"&6&"="&3\*6)) | LET(r,ROW(x),c,COLUMN(x),IF(3&lt;7,"",3<"\*"&7&"="&3\*7)) | LET(r,ROW(x),c,COLUMN(x),IF(3&lt;8,"",3<"\*"&8&"="&3\*8)) | LET(r,ROW(x),c,COLUMN(x),IF(3&lt;9,"",3<"\*"&9&"="&3\*9)) |
|  | LET(r,ROW(x),c,COLUMN(x),IF(4&lt;1,"",4<"\*"&1&"="&4\*1)) | LET(r,ROW(x),c,COLUMN(x),IF(4&lt;2,"",4<"\*"&2&"="&4\*2)) | LET(r,ROW(x),c,COLUMN(x),IF(4&lt;3,"",4<"\*"&3&"="&4\*3)) | LET(r,ROW(x),c,COLUMN(x),IF(4&lt;4,"",4<"\*"&4&"="&4\*4)) | LET(r,ROW(x),c,COLUMN(x),IF(4&lt;5,"",4<"\*"&5&"="&4\*5)) | LET(r,ROW(x),c,COLUMN(x),IF(4&lt;6,"",4<"\*"&6&"="&4\*6)) | LET(r,ROW(x),c,COLUMN(x),IF(4&lt;7,"",4<"\*"&7&"="&4\*7)) | LET(r,ROW(x),c,COLUMN(x),IF(4&lt;8,"",4<"\*"&8&"="&4\*8)) | LET(r,ROW(x),c,COLUMN(x),IF(4&lt;9,"",4<"\*"&9&"="&4\*9)) |
|  | LET(r,ROW(x),c,COLUMN(x),IF(5&lt;1,"",5<"\*"&1&"="&5\*1)) | LET(r,ROW(x),c,COLUMN(x),IF(5&lt;2,"",5<"\*"&2&"="&5\*2)) | LET(r,ROW(x),c,COLUMN(x),IF(5&lt;3,"",5<"\*"&3&"="&5\*3)) | LET(r,ROW(x),c,COLUMN(x),IF(5&lt;4,"",5<"\*"&4&"="&5\*4)) | LET(r,ROW(x),c,COLUMN(x),IF(5&lt;5,"",5<"\*"&5&"="&5\*5)) | LET(r,ROW(x),c,COLUMN(x),IF(5&lt;6,"",5<"\*"&6&"="&5\*6)) | LET(r,ROW(x),c,COLUMN(x),IF(5&lt;7,"",5<"\*"&7&"="&5\*7)) | LET(r,ROW(x),c,COLUMN(x),IF(5&lt;8,"",5<"\*"&8&"="&5\*8)) | LET(r,ROW(x),c,COLUMN(x),IF(5&lt;9,"",5<"\*"&9&"="&5\*9)) |
|  | LET(r,ROW(x),c,COLUMN(x),IF(6&lt;1,"",6<"\*"&1&"="&6\*1)) | LET(r,ROW(x),c,COLUMN(x),IF(6&lt;2,"",6<"\*"&2&"="&6\*2)) | LET(r,ROW(x),c,COLUMN(x),IF(6&lt;3,"",6<"\*"&3&"="&6\*3)) | LET(r,ROW(x),c,COLUMN(x),IF(6&lt;4,"",6<"\*"&4&"="&6\*4)) | LET(r,ROW(x),c,COLUMN(x),IF(6&lt;5,"",6<"\*"&5&"="&6\*5)) | LET(r,ROW(x),c,COLUMN(x),IF(6&lt;6,"",6<"\*"&6&"="&6\*6)) | LET(r,ROW(x),c,COLUMN(x),IF(6&lt;7,"",6<"\*"&7&"="&6\*7)) | LET(r,ROW(x),c,COLUMN(x),IF(6&lt;8,"",6<"\*"&8&"="&6\*8)) | LET(r,ROW(x),c,COLUMN(x),IF(6&lt;9,"",6<"\*"&9&"="&6\*9)) |
|  | LET(r,ROW(x),c,COLUMN(x),IF(7&lt;1,"",7<"\*"&1&"="&7\*1)) | LET(r,ROW(x),c,COLUMN(x),IF(7&lt;2,"",7<"\*"&2&"="&7\*2)) | LET(r,ROW(x),c,COLUMN(x),IF(7&lt;3,"",7<"\*"&3&"="&7\*3)) | LET(r,ROW(x),c,COLUMN(x),IF(7&lt;4,"",7<"\*"&4&"="&7\*4)) | LET(r,ROW(x),c,COLUMN(x),IF(7&lt;5,"",7<"\*"&5&"="&7\*5)) | LET(r,ROW(x),c,COLUMN(x),IF(7&lt;6,"",7<"\*"&6&"="&7\*6)) | LET(r,ROW(x),c,COLUMN(x),IF(7&lt;7,"",7<"\*"&7&"="&7\*7)) | LET(r,ROW(x),c,COLUMN(x),IF(7&lt;8,"",7<"\*"&8&"="&7\*8)) | LET(r,ROW(x),c,COLUMN(x),IF(7&lt;9,"",7<"\*"&9&"="&7\*9)) |
|  | LET(r,ROW(x),c,COLUMN(x),IF(8&lt;1,"",8<"\*"&1&"="&8\*1)) | LET(r,ROW(x),c,COLUMN(x),IF(8&lt;2,"",8<"\*"&2&"="&8\*2)) | LET(r,ROW(x),c,COLUMN(x),IF(8&lt;3,"",8<"\*"&3&"="&8\*3)) | LET(r,ROW(x),c,COLUMN(x),IF(8&lt;4,"",8<"\*"&4&"="&8\*4)) | LET(r,ROW(x),c,COLUMN(x),IF(8&lt;5,"",8<"\*"&5&"="&8\*5)) | LET(r,ROW(x),c,COLUMN(x),IF(8&lt;6,"",8<"\*"&6&"="&8\*6)) | LET(r,ROW(x),c,COLUMN(x),IF(8&lt;7,"",8<"\*"&7&"="&8\*7)) | LET(r,ROW(x),c,COLUMN(x),IF(8&lt;8,"",8<"\*"&8&"="&8\*8)) | LET(r,ROW(x),c,COLUMN(x),IF(8&lt;9,"",8<"\*"&9&"="&8\*9)) |
|  | LET(r,ROW(x),c,COLUMN(x),IF(9&lt;1,"",9<"\*"&1&"="&9\*1)) | LET(r,ROW(x),c,COLUMN(x),IF(9&lt;2,"",9<"\*"&2&"="&9\*2)) | LET(r,ROW(x),c,COLUMN(x),IF(9&lt;3,"",9<"\*"&3&"="&9\*3)) | LET(r,ROW(x),c,COLUMN(x),IF(9&lt;4,"",9<"\*"&4&"="&9\*4)) | LET(r,ROW(x),c,COLUMN(x),IF(9&lt;5,"",9<"\*"&5&"="&9\*5)) | LET(r,ROW(x),c,COLUMN(x),IF(9&lt;6,"",9<"\*"&6&"="&9\*6)) | LET(r,ROW(x),c,COLUMN(x),IF(9&lt;7,"",9<"\*"&7&"="&9\*7)) | LET(r,ROW(x),c,COLUMN(x),IF(9&lt;8,"",9<"\*"&8&"="&9\*8)) | LET(r,ROW(x),c,COLUMN(x),IF(9&lt;9,"",9<"\*"&9&"="&9\*9)) |

| 过程 |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  | IF(1&lt;1,"",1<"\*"&1&"="&1\*1) | IF(1&lt;2,"",1<"\*"&2&"="&1\*2) | IF(1&lt;3,"",1<"\*"&3&"="&1\*3) | IF(1&lt;4,"",1<"\*"&4&"="&1\*4) | IF(1&lt;5,"",1<"\*"&5&"="&1\*5) | IF(1&lt;6,"",1<"\*"&6&"="&1\*6) | IF(1&lt;7,"",1<"\*"&7&"="&1\*7) | IF(1&lt;8,"",1<"\*"&8&"="&1\*8) | IF(1&lt;9,"",1<"\*"&9&"="&1\*9) |
|  | IF(2&lt;1,"",2<"\*"&1&"="&2\*1) | IF(2&lt;2,"",2<"\*"&2&"="&2\*2) | IF(2&lt;3,"",2<"\*"&3&"="&2\*3) | IF(2&lt;4,"",2<"\*"&4&"="&2\*4) | IF(2&lt;5,"",2<"\*"&5&"="&2\*5) | IF(2&lt;6,"",2<"\*"&6&"="&2\*6) | IF(2&lt;7,"",2<"\*"&7&"="&2\*7) | IF(2&lt;8,"",2<"\*"&8&"="&2\*8) | IF(2&lt;9,"",2<"\*"&9&"="&2\*9) |
|  | IF(3&lt;1,"",3<"\*"&1&"="&3\*1) | IF(3&lt;2,"",3<"\*"&2&"="&3\*2) | IF(3&lt;3,"",3<"\*"&3&"="&3\*3) | IF(3&lt;4,"",3<"\*"&4&"="&3\*4) | IF(3&lt;5,"",3<"\*"&5&"="&3\*5) | IF(3&lt;6,"",3<"\*"&6&"="&3\*6) | IF(3&lt;7,"",3<"\*"&7&"="&3\*7) | IF(3&lt;8,"",3<"\*"&8&"="&3\*8) | IF(3&lt;9,"",3<"\*"&9&"="&3\*9) |
|  | IF(4&lt;1,"",4<"\*"&1&"="&4\*1) | IF(4&lt;2,"",4<"\*"&2&"="&4\*2) | IF(4&lt;3,"",4<"\*"&3&"="&4\*3) | IF(4&lt;4,"",4<"\*"&4&"="&4\*4) | IF(4&lt;5,"",4<"\*"&5&"="&4\*5) | IF(4&lt;6,"",4<"\*"&6&"="&4\*6) | IF(4&lt;7,"",4<"\*"&7&"="&4\*7) | IF(4&lt;8,"",4<"\*"&8&"="&4\*8) | IF(4&lt;9,"",4<"\*"&9&"="&4\*9) |
|  | IF(5&lt;1,"",5<"\*"&1&"="&5\*1) | IF(5&lt;2,"",5<"\*"&2&"="&5\*2) | IF(5&lt;3,"",5<"\*"&3&"="&5\*3) | IF(5&lt;4,"",5<"\*"&4&"="&5\*4) | IF(5&lt;5,"",5<"\*"&5&"="&5\*5) | IF(5&lt;6,"",5<"\*"&6&"="&5\*6) | IF(5&lt;7,"",5<"\*"&7&"="&5\*7) | IF(5&lt;8,"",5<"\*"&8&"="&5\*8) | IF(5&lt;9,"",5<"\*"&9&"="&5\*9) |
|  | IF(6&lt;1,"",6<"\*"&1&"="&6\*1) | IF(6&lt;2,"",6<"\*"&2&"="&6\*2) | IF(6&lt;3,"",6<"\*"&3&"="&6\*3) | IF(6&lt;4,"",6<"\*"&4&"="&6\*4) | IF(6&lt;5,"",6<"\*"&5&"="&6\*5) | IF(6&lt;6,"",6<"\*"&6&"="&6\*6) | IF(6&lt;7,"",6<"\*"&7&"="&6\*7) | IF(6&lt;8,"",6<"\*"&8&"="&6\*8) | IF(6&lt;9,"",6<"\*"&9&"="&6\*9) |
|  | IF(7&lt;1,"",7<"\*"&1&"="&7\*1) | IF(7&lt;2,"",7<"\*"&2&"="&7\*2) | IF(7&lt;3,"",7<"\*"&3&"="&7\*3) | IF(7&lt;4,"",7<"\*"&4&"="&7\*4) | IF(7&lt;5,"",7<"\*"&5&"="&7\*5) | IF(7&lt;6,"",7<"\*"&6&"="&7\*6) | IF(7&lt;7,"",7<"\*"&7&"="&7\*7) | IF(7&lt;8,"",7<"\*"&8&"="&7\*8) | IF(7&lt;9,"",7<"\*"&9&"="&7\*9) |
|  | IF(8&lt;1,"",8<"\*"&1&"="&8\*1) | IF(8&lt;2,"",8<"\*"&2&"="&8\*2) | IF(8&lt;3,"",8<"\*"&3&"="&8\*3) | IF(8&lt;4,"",8<"\*"&4&"="&8\*4) | IF(8&lt;5,"",8<"\*"&5&"="&8\*5) | IF(8&lt;6,"",8<"\*"&6&"="&8\*6) | IF(8&lt;7,"",8<"\*"&7&"="&8\*7) | IF(8&lt;8,"",8<"\*"&8&"="&8\*8) | IF(8&lt;9,"",8<"\*"&9&"="&8\*9) |
|  | IF(9&lt;1,"",9<"\*"&1&"="&9\*1) | IF(9&lt;2,"",9<"\*"&2&"="&9\*2) | IF(9&lt;3,"",9<"\*"&3&"="&9\*3) | IF(9&lt;4,"",9<"\*"&4&"="&9\*4) | IF(9&lt;5,"",9<"\*"&5&"="&9\*5) | IF(9&lt;6,"",9<"\*"&6&"="&9\*6) | IF(9&lt;7,"",9<"\*"&7&"="&9\*7) | IF(9&lt;8,"",9<"\*"&8&"="&9\*8) | IF(9&lt;9,"",9<"\*"&9&"="&9\*9) |

| 结果 |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  | 1\*1=1 |  |  |  |  |  |  |  |  |
|  | 2\*1=2 | 2\*2=4 |  |  |  |  |  |  |  |
|  | 3\*1=3 | 3\*2=6 | 3\*3=9 |  |  |  |  |  |  |
|  | 4\*1=4 | 4\*2=8 | 4\*3=12 | 4\*4=16 |  |  |  |  |  |
|  | 5\*1=5 | 5\*2=10 | 5\*3=15 | 5\*4=20 | 5\*5=25 |  |  |  |  |
|  | 6\*1=6 | 6\*2=12 | 6\*3=18 | 6\*4=24 | 6\*5=30 | 6\*6=36 |  |  |  |
|  | 7\*1=7 | 7\*2=14 | 7\*3=21 | 7\*4=28 | 7\*5=35 | 7\*6=42 | 7\*7=49 |  |  |
|  | 8\*1=8 | 8\*2=16 | 8\*3=24 | 8\*4=32 | 8\*5=40 | 8\*6=48 | 8\*7=56 | 8\*8=64 |  |
|  | 9\*1=9 | 9\*2=18 | 9\*3=27 | 9\*4=36 | 9\*5=45 | 9\*6=54 | 9\*7=63 | 9\*8=72 | 9\*9=81 |
