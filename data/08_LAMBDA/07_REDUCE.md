# REDUCE

## 语法

**REDUCE**([初始值],数组,自定义函数(累加器,当前值,表达式) | 函数)  
**REDUCE**([initial_value],array,lambda(accumulator,value,body) | function)

### 参数

1. 初始值 initial_value：初始值。
2. 数组 array：要处理的数组。
3. 自定义函数 LAMBDA：处理数组的函数。
    - 累加器 accumulator：上一步的结果。
    - 当前值 value：当前处理的值。
    - 表达式 body：处理数组的表达式。
4. 函数 function：处理数组的函数。

## 概述

对数组中的每个元素应用一个累加函数，返回最终结果

### 常见错误

1. 累计过程中存在错误，最终会返回错误。

### 补充

1. 与其他 LAMBDA 系列函数不同，REDUCE 过程和返回的值都可以是一个数组。
2. 当初始值省略时，初始值为数组的第一个元素。

## 示例

### 示例 1

```excel
REDUCE(,{1,2,3},SUM)
```

| 初始值 | 1        |
| ------ | -------- |
| 过程   | SUM(1,2) |
| 过程   | SUM(3,3) |
| 返回   | 6        |

### 示例 2

```excel
REDUCE(0,SEQUENCE(10),LAMBDA(x,y,IF(ISEVEN(y),VSTACK(x,y),x)))
```

| 过程 |     |
| ---- | --- |
|      | 0   |

| 过程 |                             |
| ---- | --------------------------- |
|      | 0                           |
|      | IF(ISEVEN(1),VSTACK(0,1),x) |

| 过程 |                             |
| ---- | --------------------------- |
|      | 0                           |
|      | IF(ISEVEN(2),VSTACK(0,2),x) |

| 过程 |     |
| ---- | --- |
|      | 0   |
|      | 2   |

| 过程 |                             |
| ---- | --------------------------- |
|      | 0                           |
|      | 2                           |
|      | IF(ISEVEN(3),VSTACK(0,3),x) |

| 过程 |     |
| ---- | --- |
|      | ... |

| 返回 |     |
| ---- | --- |
|      | 0   |
|      | 2   |
|      | 4   |
|      | 6   |
|      | 8   |
|      | 10  |
