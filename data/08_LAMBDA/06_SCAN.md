# SCAN

## 语法

**SCAN**([初始值],数组,自定义函数(累加器,当前值,表达式) | 函数) **SCAN**([initial_value],array,lambda(accumulator,value,body) | function)

### 参数

1. 初始值 initial_value：初始值。
2. 数组 array：要处理的数组。
3. 自定义函数 LAMBDA：处理数组的函数。
    - 累加器 accumulator：上一步的结果。
    - 当前值 value：当前处理的值。
    - 表达式 body：处理数组的表达式。
4. 函数 function：处理数组的函数。

## 概述

对数组中的每个元素应用一个累加函数，并返回每个中间结果的数组。

### 常见错误

1. 传入的函数返回必须是一个值，不能是数组，否则因无法展开报错。

### 补充

1. 当初始值省略时，初始值为数组的第一个元素。

## 示例

### 示例 1

```excel
SCAN(,{1,2,3},SUM)
```

| 过程 |     |
| ---- | --- |
|      | 1   |

| 过程 |     |     |
| ---- | --- | --- |
|      | 1   | 1+2 |

| 过程 |     |     |     |
| ---- | --- | --- | --- |
|      | 1   | 1+2 | 3+3 |

| 返回 |     |     |     |
| ---- | --- | --- | --- |
|      | 1   | 3   | 6   |

---

### 示例 2

```excel
SCAN("0到10的偶数有：0",SEQUENCE(10),LAMBDA(x,y,IF(ISEVEN(y),x&","&y,x)))
```

| 过程 |                                                                 |
| ---- | --------------------------------------------------------------- |
|      | IF(ISEVEN(1),"0 到 10 的偶数有：0"&","&1,"0 到 10 的偶数有：0") |

| 过程 |                                                                 |
| ---- | --------------------------------------------------------------- |
|      | "0 到 10 的偶数有：0"                                           |
|      | IF(ISEVEN(2),"0 到 10 的偶数有：0"&","&2,"0 到 10 的偶数有：0") |

| 过程 |                                                                     |
| ---- | ------------------------------------------------------------------- |
|      | "0 到 10 的偶数有：0"                                               |
|      | "0 到 10 的偶数有：0,2"                                             |
|      | IF(ISEVEN(3),"0 到 10 的偶数有：0,2"&","&3,"0 到 10 的偶数有：0,2") |

| 过程 |     |
| ---- | --- |
|      | ... |

| 返回 |                                |
| ---- | ------------------------------ |
|      | 0 到 10 的偶数有：0            |
|      | 0 到 10 的偶数有：0,2          |
|      | 0 到 10 的偶数有：0,2          |
|      | 0 到 10 的偶数有：0,2,4        |
|      | 0 到 10 的偶数有：0,2,4        |
|      | 0 到 10 的偶数有：0,2,4,6      |
|      | 0 到 10 的偶数有：0,2,4,6      |
|      | 0 到 10 的偶数有：0,2,4,6,8    |
|      | 0 到 10 的偶数有：0,2,4,6,8    |
|      | 0 到 10 的偶数有：0,2,4,6,8,10 |
